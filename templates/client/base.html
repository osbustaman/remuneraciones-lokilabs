{% load static_tags %} {% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">ß
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Sección: {% block title %} {% endblock %}</title>

    <!-- vendor css -->
    <link href="{% statics_tag_amanda 'lib/font-awesome/css/font-awesome.css' %}" rel="stylesheet">
    <link href="{% statics_tag_amanda 'lib/Ionicons/css/ionicons.css' %}" rel="stylesheet">
    <link href="{% statics_tag_amanda 'lib/perfect-scrollbar/css/perfect-scrollbar.css' %}" rel="stylesheet">
    <link href="{% statics_tag_amanda 'lib/jquery-toggles/toggles-full.css' %}" rel="stylesheet">
    <link href="{% statics_tag_amanda 'lib/highlightjs/github.css' %}" rel="stylesheet">
    <link href="{% statics_tag_amanda 'lib/select2/css/select2.min.css' %}" rel="stylesheet">
    <link href="{% statics_tag_amanda 'lib/spectrum/spectrum.css' %}" rel="stylesheet">

    <script src="{% statics_tag_amanda 'lib/jquery/jquery.js' %}"></script>
    <link href="{% statics_tag 'vendors/jqueyconfirm/jquery-confirm.min.css' %}" rel="stylesheet">
    <script src="{% statics_tag 'vendors/jqueyconfirm/jquery-confirm.min.js' %}"></script>

    <script src="{% statics_tag_amanda 'lib/axios/axios.min.js' %}"></script>

    {% block static_up %} {% endblock %}

    <!-- Amanda CSS -->
    <link rel="stylesheet" href="{% statics_tag_amanda 'css/amanda.css' %}">
    <style>
        .am-pagetitle .search-bar {
            right: 28px !important;
        }
        
        .img-thumbnail-logo {
            padding: 0;
            max-width: 30%;
            height: auto;
        }
        
        .select2-container {
            width: 100% !important;
        }
        
        .am-sideleft-menu>.nav-item>.nav-link.show-sub::after {
            content: '';
        }

        .div-scroll-475{
            height: 5em;
            line-height: 1em;
            overflow-x: hidden;
            overflow-y: scroll;
            width: 100%;
            min-height: 475px;
        }
    </style>
</head>

<body>

    <div class="am-header">
        <div class="am-header-left">
            <a id="naviconLeft" href="" class="am-navicon d-none d-lg-flex"><i class="icon ion-navicon-round"></i></a>
            <a id="naviconLeftMobile" href="" class="am-navicon d-lg-none"><i class="icon ion-navicon-round"></i></a>
            <a href="javascript:void()" class="am-logo">
                <img src="{{ request.session.logo_company }}" width="450" class="img-fluid img-thumbnail img-thumbnail-logo" alt="">

            </a>
        </div>
        <!-- am-header-left -->

        <div class="am-header-right">
            <!-- notification.html -->
            <div class="dropdown dropdown-profile">
                <a href="" class="nav-link nav-link-profile" data-toggle="dropdown">
                    <img src="http://themepixels.me/demo/amanda/img/img3.jpg" class="wd-32 rounded-circle" alt="">
                    <span class="logged-name"><span class="hidden-xs-down">{{ request.session.first_name|title }} {{ request.session.last_name|title }}</span> <i class="fa fa-angle-down mg-l-3"></i></span>
                </a>
                <div class="dropdown-menu wd-200">
                    <ul class="list-unstyled user-profile-nav">
                        <li><a href="{% url 'account_base:logout_client' %}"><i class="icon ion-power"></i> Cerrar Sesión</a></li>

                        {% if request.session.user_nivel == 8 or request.session.user_nivel == 1 or request.session.user_nivel == 2 %} {% for e in request.session.list_company %}
                        <li><a href="{% url 'emp_app:cambiar_empresa' e.key %}">{{e.value|title}}</a></li>
                        {% endfor %} {% endif %}

                    </ul>
                </div>
                <!-- dropdown-menu -->
            </div>
            <!-- dropdown -->
        </div>
        <!-- am-header-right -->
    </div>
    <!-- am-header -->

    <div class="am-sideleft">
        <ul class="nav am-sideleft-tab">
            <li class="nav-item">
                <a href="#mainMenu" class="nav-link active"><i class="icon ion-ios-home-outline tx-24"></i></a>
            </li>
            <li class="nav-item">
                <a href="#emailMenu" class="nav-link"><i class="icon ion-ios-email-outline tx-24"></i></a>
            </li>
            <li class="nav-item">
                <a href="#chatMenu" class="nav-link"><i class="icon ion-ios-chatboxes-outline tx-24"></i></a>
            </li>
            <li class="nav-item">
                <a href="#settingMenu" class="nav-link"><i class="icon ion-ios-gear-outline tx-24"></i></a>
            </li>
        </ul>

        <div class="tab-content">
            <div id="mainMenu" class="tab-pane active">
                <ul class="nav am-sideleft-menu">
                    <li class="nav-item">
                        <a href="{% url 'usuario_app:init_page' %}" class="nav-link {% if request.session.item == 'inicio' %}active show-sub{% else %}{% endif %}">
                            <i class="icon ion-ios-home-outline"></i>
                            <span>Incio</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    {% include "client/includes/items_colaborador.html" %} 
                    {% if request.session.user_nivel == 8 or request.session.user_nivel == 1 or request.session.user_nivel == 2 %} 
                        {% include "client/includes/items_rrhh.html" %} 
                    {% elif request.session.user_nivel == 3 %} 
                        {% include "client/includes/items_lider.html" %} 
                    {% endif %}


                </ul>
            </div>
            <!-- #mainMenu -->

            <div id="emailMenu" class="tab-pane">
                <div class="pd-x-20 pd-y-10">
                    <a href="" class="btn btn-orange btn-block btn-compose">Compose Email</a>
                </div>
                <ul class="nav am-sideleft-menu">
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-filing-outline"></i>
                            <span>Inbox</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-filing-outline"></i>
                            <span>Drafts</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-paperplane-outline"></i>
                            <span>Sent</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-trash-outline"></i>
                            <span>Trash</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-filing-outline"></i>
                            <span>Spam</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                </ul>

                <label class="pd-x-20 tx-uppercase tx-11 mg-t-10 tx-orange mg-b-0 tx-medium">My Folder</label>
                <ul class="nav am-sideleft-menu">
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-folder-outline"></i>
                            <span>Updates</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-folder-outline"></i>
                            <span>Social</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                    <li class="nav-item">
                        <a href="page-inbox.html" class="nav-link">
                            <i class="icon ion-ios-folder-outline"></i>
                            <span>Promotions</span>
                        </a>
                    </li>
                    <!-- nav-item -->
                </ul>
            </div>
            <!-- #emailMenu -->
            <div id="chatMenu" class="tab-pane">
                <div class="chat-search-bar">
                    <input type="search" class="form-control wd-150" placeholder="Search chat...">
                    <button class="btn btn-secondary"><i class="fa fa-search"></i></button>
                </div>
                <!-- chat-search-bar -->

                <label class="pd-x-15 tx-uppercase tx-11 mg-t-20 tx-orange mg-b-10 tx-medium">Recent Chat
                    History</label>
                <div class="list-group list-group-chat">
                    <a href="#" class="list-group-item">
                        <div class="d-flex align-items-center">
                            <img src="http://themepixels.me/demo/amanda/img/img6.jpg" class="wd-32 rounded-circle" alt="">
                            <div class="mg-l-10">
                                <h6>Russell M. Evans</h6>
                                <span>Tuesday, 10:33am</span>
                            </div>
                        </div>
                        <!-- d-flex -->
                        <p>Nor again is there anyone who loves or pursues or desires to obtain pain of itself, because it is pain...</p>
                    </a>
                    <!-- list-group-item -->
                    <a href="#" class="list-group-item">
                        <div class="d-flex align-items-center">
                            <img src="http://themepixels.me/demo/amanda/img/img7.jpg" class="wd-32 rounded-circle" alt="">
                            <div class="mg-l-10">
                                <h6>James F. Sears</h6>
                                <span>Monday, 4:21pm</span>
                            </div>
                        </div>
                        <!-- d-flex -->
                        <p>But who has any right to find fault with a man who chooses to enjoy a pleasure that has...
                        </p>
                    </a>
                    <!-- list-group-item -->
                    <a href="#" class="list-group-item">
                        <div class="d-flex align-items-center">
                            <img src="http://themepixels.me/demo/amanda/img/img8.jpg" class="wd-32 rounded-circle" alt="">
                            <div class="mg-l-10">
                                <h6>Sharon R. Rowe</h6>
                                <span>Sunday, 7:45pm</span>
                            </div>
                        </div>
                        <!-- d-flex -->
                        <p>But I must explain to you how all this mistaken idea of denouncing pleasure and praising...
                        </p>
                    </a>
                    <!-- list-group-item -->
                    <a href="#" class="list-group-item">
                        <div class="d-flex align-items-center">
                            <img src="http://themepixels.me/demo/amanda/img/img9.jpg" class="wd-32 rounded-circle" alt="">
                            <div class="mg-l-10">
                                <h6>Ruby M. Martin</h6>
                                <span>Sunday, 7:45pm</span>
                            </div>
                        </div>
                        <!-- d-flex -->
                        <p>But I must explain to you how all this mistaken idea of denouncing pleasure and praising...
                        </p>
                    </a>
                    <!-- list-group-item -->
                    <a href="#" class="list-group-item">
                        <div class="d-flex align-items-center">
                            <img src="http://themepixels.me/demo/amanda/img/img10.jpg" class="wd-32 rounded-circle" alt="">
                            <div class="mg-l-10">
                                <h6>Joslyn C. Mayo</h6>
                                <span>Sunday, 7:45pm</span>
                            </div>
                        </div>
                        <!-- d-flex -->
                        <p>But I must explain to you how all this mistaken idea of denouncing pleasure and praising...
                        </p>
                    </a>
                    <!-- list-group-item -->
                </div>
                <!-- list-group -->
                <span class="d-block pd-15 tx-12">Loading messages...</span>

            </div>
            <!-- #chatMenu -->
            <div id="settingMenu" class="tab-pane">
                <div class="pd-x-15">
                    <label class="tx-uppercase tx-11 mg-t-10 tx-orange mg-b-15 tx-medium">Quick Settings</label>
                    <div class="bd pd-15">
                        <h6 class="tx-13 tx-normal tx-gray-800">Daily Newsletter</h6>
                        <p class="tx-12">Get notified when someone else is trying to access your account.</p>
                        <div class="toggle toggle-light warning"></div>
                    </div>
                    <!-- bd -->

                    <div class="bd pd-15 mg-t-15">
                        <h6 class="tx-13 tx-normal tx-gray-800">Call Phones</h6>
                        <p class="tx-12">Make calls to friends and family right from your account.</p>
                        <div class="toggle toggle-light warning"></div>
                    </div>
                    <!-- bd -->

                    <div class="bd pd-15 mg-t-15">
                        <h6 class="tx-13 tx-normal tx-gray-800">Login Notifications</h6>
                        <p class="tx-12">Get notified when someone else is trying to access your account.</p>
                        <div class="toggle toggle-light warning"></div>
                    </div>
                    <!-- bd -->

                    <div class="bd pd-15 mg-t-15">
                        <h6 class="tx-13 tx-normal tx-gray-800">Phone Approvals</h6>
                        <p class="tx-12">Use your phone when login as an extra layer of security.</p>
                        <div class="toggle toggle-light warning"></div>
                    </div>
                    <!-- bd -->
                </div>
            </div>
            <!-- #settingMenu -->
        </div>
        <!-- tab-content -->
    </div>
    <!-- am-sideleft -->

    <div class="am-pagetitle">
        <h5 class="am-title">{{ request.session.emp_namecompany | title }}: {% block title_page %}{% endblock %}</h5>
        <div id="searchBar" class="search-bar">
            {% block buttons %}{% endblock %}
        </div>
    </div>
    <!-- am-pagetitle -->

    <div class="am-mainpanel">
        <div class="am-pagebody">
            {% block content_page %}content_page{% endblock %}
        </div>
        <!-- am-pagebody -->
        <br>
        <div class="am-footer">
            <span>LokiLabs 2023 - Loki-Remuneraciones. Derechos Reservados a LokiLabs.</span>
            <span>Nombre Cliente.</span>
        </div>
        <!-- am-footer -->
    </div>
    <!-- am-mainpanel -->

    <script src="{% statics_tag_amanda 'lib/popper.js/popper.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/bootstrap/bootstrap.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/perfect-scrollbar/js/perfect-scrollbar.jquery.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/jquery-toggles/toggles.min.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/jquery-ui/jquery-ui.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/highlightjs/highlight.pack.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/select2/js/select2.min.js' %}"></script>
    <script src="{% statics_tag_amanda 'lib/spectrum/spectrum.js' %}"></script>

    {% block static_down %} {% endblock %}

    <script src="{% statics_tag_amanda 'js/amanda.js' %}"></script>
    <script src="{% statics_tag_amanda 'js/js.cookie.js' %}"></script>

    {% block script_tag %} {% endblock %}

    <script>
        /** @type {HTMLElement}*/
        let latitude;
        /** @type {HTMLElement} */
        let longitude;
    
        window.addEventListener('load', function(){
            navigator.geolocation.getCurrentPosition(geoposOK, geoposKO);
        });
    
        /** @param {GeolocationPosition} pos */
        function geoposOK(pos) {
            //Obtenemos latitud y longitud
            latitude = pos.coords.latitude;
            longitude = pos.coords.longitude;
    
            const crate_json = {
                "startLatitude": latitude,
                "startLongitude":longitude
            }
    
            $("#lat_lng").text(`${crate_json['startLatitude']}, ${crate_json['startLongitude']}`)
    
            const accessToken = "pk.eyJ1Ijoib3NidXN0YW1hbiIsImEiOiJjbGpyamw4Y2IwZHNjM2VrY256bjF4a3J3In0.BREjlIuXom4d7eS_riSSNQ";
            // Inicializar el mapa
            var map = L.map('map').setView([crate_json['startLatitude'], crate_json['startLongitude']], 16);
    
            // Agregar el mapa base (utilizando Mapbox)
            L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=' + accessToken, {
                maxZoom: 25,
                id: 'mapbox/streets-v11',
                tileSize: 512,
                zoomOffset: -1
            }).addTo(map);
    
            L.marker([crate_json['startLatitude'], crate_json['startLongitude']]).addTo(map)
                    .bindPopup(location.name)
                    .openPopup();
        }
    
        /** @param {GeolocationPositionError} err */
        function geoposKO(err) {
            console.warn(err.message);
            let msg;
            switch(err.code) {
                case err.PERMISSION_DENIED:
                    msg = "No nos has dado permiso para obtener tu posición";
                    break;
                case err.POSITION_UNAVAILABLE:
                    msg = "Tu posición actual no está disponible";
                    break;
                    case err.TIMEOUT:
                        msg = "No se ha podido obtener tu posición en un tiempo prudencial";
                        break;
                    default:
                        msg = "Error desconocido";
                        break;
            }
            //posElt.textContent = msg;
        }
        
    </script>    

</body>

</html>