<form method="post" id="form-payment" name="form-payment" action="{% url 'usuario_app:add_form_payment' id col_id %}">
    {% csrf_token %}

    <div class="form-layout">
        <div class="row mg-b-25">

            <div class="col-md-4">
                <div class="form-group">
                    <label class="form-control-label">{{ formFormsPayments.col_formapago.label }} <span class="tx-danger">*</span></label>
                    {{ formFormsPayments.col_formapago }}
                </div>
            </div><!-- col-4 -->

            <div class="col-md-4">
                <div class="form-group">
                    <label class="form-control-label">{{ formFormsPayments.banco.label }} <span class="tx-danger"></span></label>
                    {{ formFormsPayments.banco }}
                </div>
            </div><!-- col-4 -->
            <div class="col-lg-4">
                <div class="form-group">
                    <label class="form-control-label">{{ formFormsPayments.col_tipocuenta.label }} <span class="tx-danger"></span></label>
                    {{ formFormsPayments.col_tipocuenta }}
                </div>
            </div><!-- col-4 -->
            <div class="col-lg-4">
                <div class="form-group">
                    <label class="form-control-label">{{ formFormsPayments.col_cuentabancaria.label }} <span class="tx-danger"></span></label>
                    {{ formFormsPayments.col_cuentabancaria }}
                </div>
            </div><!-- col-4 -->
        </div>
        

        <div class="form-layout-footer mg-t-30">
            <button type="submit" class="btn btn-info mg-r-5">Guardar</button>
        </div><!-- form-layout-footer -->
    </div>
</form>
{% if messages %}
{% for message in messages %}
{% if message.tags == 'error' %}
<div class="alert alert-danger mt-4" role="alert">
{% else %}
<div class="alert alert-success mt-4" role="alert">
{% endif %}
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <div class="d-flex align-items-center justify-content-start">
        <i class="icon ion-ios-{% if message.tags == 'error' %}close{% else %}checkmark{% endif %} alert-icon tx-32 mg-t-5 mg-xs-t-0"></i>
        <span><strong>{% if message.tags == 'error' %}Error{% else %}Éxito{% endif %}: </strong> {{ message }}</span>
    </div><!-- d-flex -->
</div><!-- alert -->
{% endfor %}
{% endif %}

<script>

    
    $().ready(function(){
        const id_col_formapago = document.getElementById('id_col_formapago').value;
        const id_banco = document.getElementById('id_banco').value;
        const id_col_tipocuenta = document.getElementById('id_col_tipocuenta').value;
        const id_col_cuentabancaria = document.getElementById('id_col_cuentabancaria').value;

        $("#id_col_formapago").on('select2:select', function (e) {
            const { text, id } = e.params.data;
            if (id == 4){
                $("#id_banco, #id_col_tipocuenta, #id_col_cuentabancaria").prop("disabled", false);
                $("#id_banco").val(id_banco).trigger('change');
                $("#id_col_tipocuenta").val(id_col_tipocuenta).trigger('change');
                $("#id_col_cuentabancaria").val(id_col_cuentabancaria);
            }else{
                $("#id_banco, #id_col_tipocuenta, #id_col_cuentabancaria").prop("disabled", true);
                $("#id_col_cuentabancaria").val('');
                resetSelect2();
            }
            
        });

        function resetSelect2() {
            // Desvincula el select2 del elemento y luego destrúyelo
            $("#id_banco, #id_col_tipocuenta").select2('destroy');
            $("#id_banco").val('');
            $("#id_col_tipocuenta").val(0);

            // Vuelve a vincular el select2 al elemento
            $("#id_banco, #id_col_tipocuenta").select2();
        }

        if(id_col_formapago == 4){
            $("#id_banco, #id_col_tipocuenta, #id_col_cuentabancaria").prop("disabled", false);
        }else{
            $("#id_banco, #id_col_tipocuenta, #id_col_cuentabancaria").prop("disabled", true);
        }
    });
</script>
    